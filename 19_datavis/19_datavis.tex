\documentclass[aspectratio=169,12pt,t]{beamer}

\usepackage{graphicx}
\setbeameroption{hide notes}
\setbeamertemplate{note page}[plain]
\usepackage{listings}

\input{../LaTeX/header.tex}

\title{Data visualization}
\author{\href{https://kbroman.org}{Karl Broman}}
\institute{Biostatistics \& Medical Informatics, UW{\textendash}Madison}
\date{\href{https://kbroman.org}{\tt \scriptsize \color{foreground} kbroman.org}
\\[-4pt]
\href{https://github.com/kbroman}{\tt \scriptsize \color{foreground} github.com/kbroman}
\\[-4pt]
\href{https://twitter.com/kwbroman}{\tt \scriptsize \color{foreground} @kwbroman}
\\[-4pt]
{\scriptsize Course web: \href{https://kbroman.org/AdvData}{\tt kbroman.org/AdvData}}
}


\begin{document}


{
\setbeamertemplate{footline}{} % no page number here
\frame{
  \titlepage

\note{
  My goal in this lecture is to explain some basic principles of data
  visualization. My focus here is on simple graphs with not too many
  data points.
}
} }


\begin{frame}{Displaying data well}

\bbi
\item Be accurate and clear.

\item Let the data speak.

\bi
\item Show as much information as possible, taking care not to
  obscure the message.
\ei

\item Science not sales.

\bi
\item Avoid unnecessary frills (esp. gratuitous 3d).
\ei

\item In tables, every digit should be meaningful. Don't drop ending 0's.
\ei

\note{
    The key principles of data visualization for us are to be
    accurate and clear, and to let the data speak. We want to show as
    much information as possible, but to a point: we don't want to
    obscure the message.

    For data scientists, this should be about science rather than
    sales. You want to focus on conveying the truth not persuading or
    arguing a particular angle. And you want to avoid unnecessary
    frills. That's not to say that good graphs can't be pretty, but
    they should be over-the-top with junk that gets in the way of
    presenting the data, like gratuitous 3-dimensional rendering.

    In tables, every digit should be meaningful, but you shouldn't
    drop ending zeros as they indicate precision.
}
\end{frame}




\begin{frame}[c]{Show the data}

\begin{columns}
\column{0.5\textwidth}

\figw{Figs/fig1a.png}{1.0}


\column{0.5\textwidth}

\only<1|handout 0>{\figw{Figs/fig1c.png}{1.0}}
\only<2|handout 0>{\figw{Figs/fig1d.png}{1.0}}
\only<3>{\figw{Figs/fig1e.png}{1.0}}
\only<4|handout 0>{\figw{Figs/fig1f.png}{1.0}}
\only<5|handout 0>{\figw{Figs/fig1g.png}{1.0}}
\only<6|handout 0>{\figw{Figs/fig1h.png}{1.0}}


\end{columns}

\note{
  First, show the data. Particularly in a case like this where you
  have just a few data points in each of two groups, it would be a
  shame to not show the actual data. Bar plots with antennas give you
  just a couple of numbers, and 3-dimensional bars make it hard even
  to see them. In the figure on the right, the bars are sitting in
  front of the axis, and so you need to project back in order to
  figure out what the numbers are.

  There's a lot of fancy stuff that you can do in Excel. But is it
  helping the reader to better understand the data, or is it making it
  harder?
}

\end{frame}




\begin{frame}[c]{Avoid pie charts}


\begin{columns}
\column{0.5\textwidth}

\figw{Figs/fig2a_rev.png}{1.0}


\column{0.5\textwidth}

\only<1|handout 0>{\figw{Figs/fig2c.png}{1.0}}
\only<2|handout 0>{\figw{Figs/fig2d.png}{1.0}}
\only<3>{\figw{Figs/fig2e.png}{1.0}}

\end{columns}

\note{
  Pie charts are seldom a good solution. 3d pie charts are the worst.

  The problem is, humans are terrible at judging areas. That's why pie
  charts so often show the percentages next to the slices. To do so
  seems an admission of defeat.

  I don't much like bar charts, but they're much more effective for
  the actual comparison of values, which is the point of such a chart.

  Pie charts have one advantage: for numbers that add up to 100\%,
  they make that part clear. But in all other ways, they are
  ineffective. And the more slices there are, the worse they get.

  There can be a case for pie charts with two slices. But I would
  mostly avoid them, and would at least switch to a bar chart.
}
\end{frame}





\begin{frame}{Avoid pie charts}

\only<1|handout 0>{\figh{Figs/piecharts.pdf}{0.81}}
\only<2|handout 0>{\figh{Figs/piecharts_3d.pdf}{0.81}}
\only<3|handout 0>{\figh{Figs/piecharts_3d_w_bars.pdf}{0.81}}
\only<4>{\figh{Figs/piecharts_w_bars.pdf}{0.81}}

\bigskip

\hfill \lolit \footnotesize
via \href{https://twitter.com/MonaChalabi/status/527121946073632768/photo/1}{\tt @MonaChalabi}
(\href{https://bit.ly/pie_vs_barchart}{\tt bit.ly/pie\_vs\_barchart})

\note{
  Here's another example. You really can't distinguish the values in
  the pie chart, but it's easy to compare them when viewed as a bar
  chart.
}
\end{frame}






\begin{frame}{Consider logs}

\begin{columns}
\column{0.5\textwidth}

\figw{Figs/fig3a.png}{1.0}


\column{0.5\textwidth}

\only<1>{\figw{Figs/fig3b.png}{1.0}}
\only<2|handout 0>{\figw{Figs/fig3c.png}{1.0}}
\only<3|handout 0>{\figw{Figs/fig3d.png}{1.0}}

\end{columns}

\note{
  Always consider transforming the data by taking logs. This is
  particular important if the data span multiple orders of magnitude,
  which is particularly common for cytokines and gene expression
  measurements.

}
\end{frame}



\begin{frame}[c]{Consider logs}

\only<1|handout 0>{\figh{Figs/fig5c.png}{0.85}}
\only<2|handout 0>{\figh{Figs/fig5d.png}{0.85}}
\only<3|handout 0>{\figh{Figs/fig5e.png}{0.85}}
\only<4>{\figh{Figs/fig5f.png}{0.85}}
\only<5|handout 0>{\figh{Figs/fig5b.png}{0.85}}

\note{
   This is a plot of gene expression values from two replicate
   microarrays. The values are so skewed, that unless you take logs,
   the figure is dominated by a few very large points. 50\% of the
   data are below the pink line, and 99\% of the data are below the
   blue line. If we take logs, we get to see more of the data.
}
\end{frame}





\begin{frame}[c]{Consider differences}

\figh{Figs/fig5a.png}{0.85}

\note{
   Also, if you're interested in the differences between the two
   arrays, it's best to subtract the values and look at the
   differences directly. The differences on the log scale are the same
   as the log ratios.

   This prevents us all from having to rotate our heads 45 degrees to
   look for points off the diagonal.

   This is sometimes called an ``MA plot,'' though I'm not sure why
   ``M'' and ``A.'' I'd call it a difference-vs-average plot.
   Note how it also makes more complete use of the space.
}
\end{frame}



\begin{frame}[c]{Another ``{\hilit take logs}'' example}

\figh{Figs/broman_fig1.jpg}{0.80}

\vfill \hfill \footnotesize \lolit
Broman et al., Am J Hum Genet 63:861-869, 1998, Fig. 1

\note{
  Ratios are another case where it can be important to take logs.

  I've shown this figure before; it's a bit of an embarrassment to me
  now. This is a plot of a female/male ratio. When female $>$ male, the
  values span from 1 to infinity, whereas if male $>$ female, the
  values are smashed between 0 and 1.

  If I'd taken logs, there'd be a nice symmetry between the ratios $>$
  1 and those $<$ 1.
}
\end{frame}





\begin{frame}{Ease comparisons}

\hilit (things to be compared should be adjacent)

\bigskip

\figw{Figs/ease_comparisons_1.pdf}{1.0}

\note{
    To ease comparisons, you want to put the things to be compared
    next to each other.

    These two figures show the average phenotype value for three
    different genotypes, and also split by sex. In the version on the
    left, the two sexes are next to each other; in the version on the
    right, the three genotypes are next to each other.

    There are always trade-offs in data visualization. If you are most
    interested in comparing the two sexes within each genotype, you
    should go with the version on the left. If you are most interested
    in comparing the three genotypes (controlling for sex), you should
    go with the right version.
}
\end{frame}





\begin{frame}{Ease comparisons}

\hilit (add a bit of color)

\bigskip

\figw{Figs/ease_comparisons_2.pdf}{1.0}

\note{
  Color can be useful to help guide comparisons.

  But note that here I've used stereotypical color choices. In a way,
  this graph reinforces that ``pink for girls; blue for boys''
  stereotype. It has the advantage that it might be easier to
  remember, but that's probably not worth the disadvantage of
  reinforcing an unfortunate stereotype, and so I'd avoid this choice
  of colors, now. We could instead go with, say, green and purple.
}
\end{frame}




\begin{frame}[c]{Which comparison is easiest?}

\figw{Figs/which_comparison.pdf}{1.0}

\note{
  There are a variety of different plots in which you might be
  comparing two values, A and B. Which one is easiest?

  It's easiest if you're comparing positions, and if they're right
  next to each other. Move them apart or compress them or offset the
  lengths, and they become harder. Hardest of all is the pie chart,
  where you're comparing areas or maybe angles.

  This is important for when you are designing a visualization. There
  are often a variety of comparisons that you want to be making. But
  think about which ones are the most important ones.
}
\end{frame}


\begin{frame}{Don't distort the quantities}

{\hilit
  \only<1>{(value $\propto$ radius)}
  \only<2|handout 0>{(value $\propto$ area)}
}

\bigskip

\only<1>{\figh{Figs/circles_1.pdf}{0.75}}
\only<2|handout 0>{\figh{Figs/circles_2.pdf}{0.75}}

\note{
  Another key principle is to not distort the quantities. Here, the
  sizes of the genomes are proportional to the diameters of the
  circles. But one naturally focuses on the areas of the circles.

  If you change the figure so that the values are proportional to the
  areas, you get a more realistic view of the data. The wheat genome
  is like 5$\times$ that of the human, and the human genome is like
  20$\times$ that of arabidopsis (a model plant). But it's still
  pretty hard to see that without showing the numbers, because humans
  just aren't so good at comparing areas.
}
\end{frame}



\begin{frame}{Don't use areas at all}

{\hilit
  (value $\propto$ height)
}

\bigskip

\figh{Figs/circles_3.pdf}{0.75}

\note{
   This plot is not nearly so interesting, but it does a much better
   job of conveying the values.
}
\end{frame}





\begin{frame}{Encoding data}

\begin{columns}
\column{0.5\textwidth}

{\hilit Quantities}

\bi
\item Position
\item Length
\item Angle
\item Area
\item Luminance {\lolit (light/dark)}
\item Chroma {\lolit (amount of color)}
\ei

\column{0.5\textwidth}

{\hilit Categories}

\bi
\item Shape
\item Hue {\lolit (which color)}
\item Texture
\item Width
\ei

  \end{columns}

\note{
   In any data visualizations, you're encoding quantities or
   categories using visual features. There are a variety of choices
   you can make, and they vary enormously in the ease of the reader of
   decoding the values.

   Position is easier then length which is easier than angle which is
   maybe easier than area which is easier than shading or color.

   Shape is easier than color which is easier than texture (like
   cross-hatching) which is easier than line width.
}
\end{frame}




\begin{frame}{Ease comparisons}

{\hilit (align axes)}

\figh{Figs/histograms_1.pdf}{0.85}

\note{
  Another important technique is to align axes to ease comparisons. If
  you're comparing the heights of women and men, it is much easier to
  do so with them stacked on top of each other rather than
  side-by-side.
}
\end{frame}




\begin{frame}{Ease comparisons}

{\hilit (use common axes)}

\figh{Figs/histograms_2.pdf}{0.85}

\note{
  You also want to use common axes as much as possible, as in the
  panels on the left.

  If you allow the axes to differ, as in the panels on the right, the
  reader has a much harder time comparing the values.
}
\end{frame}







\begin{frame}[c]{Use labels not legends}

\figw{Figs/direct_labels.pdf}{1.0}

\note{
   Another thing I really like to emphasize is the value of placing
   labels directly in the plot (as in the right panel) rather than
   using a separate legend (as in the left panel) or even worse
   explaining the colors in the figure caption.

   It is arguably more difficult to place labels directly on the plot.
   It generally requires some extra effort to get the labels right.
   But for a figure in a paper or talk, it's often worth the effort.
}
\end{frame}





\begin{frame}[c]{Don't sort alphabetically}

\figw{Figs/alphabet.pdf}{1.0}

\note{
   Never sort things alphabetically. It's basically always better to
   sort by the value, or sort by the value of one variable and have
   related panels in that same order.

   In the panel on the right, you can immediately see important
   relationships (such as by health care spending differences by
   continent).

   The alphabetical order in the panel on the left is good only for
   looking up a particular country, and that's not worth it.
}
\end{frame}





\begin{frame}[c]{Must you include 0?}

\figw{Figs/include_zero.pdf}{1.0}

\note{
  A common question is whether you should include 0 in the y-axis.
  In bar charts, I think it is misleading to not include 0. But much
  of the time, it's better to not use bars and just use line segments
  or dots, and then in that case it can be useful to focus just on the
  interval with the data.

  Here, we're looking at detection rates near 100\%, and it's much
  better to focus on the high-end of the range, so we can see the
  differences. Thus, it's best to omit the bars.

  I'd also say that if you have something that's constrained to
  0--100\%, it's best to have the y-axis constrained to those limits.
  Having the range go above 100\% or below 0\% is a bit silly.

  The choice of whether you should include 0 or not is partly
  dependent on the audience. Will they be misled by using a focused
  interval, or not?
}
\end{frame}




\begin{frame}[c]{A bad table}

\figh{Figs/tableB.png}{0.7}

\note{
  This is a really bad table. It's actually taken from the Journal of
  the American Statistical Association, which is the flagship
  journal for the largest society of statisticians in the US.
  Statisiticians can be really terrible at data visualization. They
  are often lazy and revert to tables, and their tables are often
  terrible, like this one.

  There are way too many digits shown. We almost never can measure
  things to more than 3 digits. And you can just tell, looking down
  each column, than no more than 3 digits are needed to tell the
  key story.

  Also, leading 0's are omitted. If we need five digits in 0.38267,
  then we should show the same precision in 0.44600.

  Related to that, the numbers are centered, rather than being aligned
  at the decimal point. {\hilit Always} align numbers at the decimal
  point.
}
\end{frame}


\begin{frame}[c]{Fewer digits}

\figh{Figs/tableA.png}{0.7}

\note{
  Here's the same table, corrected. Two digits is really sufficient;
  the previous table had 3$\times$ as many digits as were necessary.
  Also, don't drop the ending 0's and line things up the numbers at
  the decimal point.
}
\end{frame}





\begin{frame}[c]{Yuck!}

\only<1>{\figh{Figs/lancet_table.pdf}{0.8}}
\only<2|handout 0>{\figh{Figs/lancet_table_crop.png}{0.8}}

\vspace{12pt}
\lolit \footnotesize \hfill
Feigen et al., Lancet 383:245-255, 2014, Table 1

\note{
   Here's a table from the Lancet. Epidemiologists are expert in
   creating terrible tables. There is so much that is wrong with this
   table.
}
\end{frame}

\begin{frame}{What was wrong with that?}

  \bbi
\item {\vhilit Way} too many digits.

\item Numbers aren't aligned.

\item Numbers to be compared aren't anywhere near each other.

\item The interesting comparisons are horizontal rather than
  vertical.

\item It would be much better as a multi-panel figure.
\ei

\note{
  Here's a summary of what was wrong with that Lancet table.

  It's interesting to note that it tends to be easier to compare
  numbers vertically rather than horizontally. So arrange the table so
  that the key comparisons are with numbers near each other, and
  ideally going up-and-down rather than side-to-side.

  Even better would be to show these data as a graph. Seldom is one
  interested in the detailed quantitative values; rather, you'd be
  looking for qualitative differences which would be much easier to
  see in a graph.
}
\end{frame}


\begin{frame}{One last example}

\begin{columns}

\column{0.12\textwidth}

\column{0.25\textwidth}

\figh{Crashes/Figs/chalabi-dearmona-distracted.png}{0.75}

\column{0.25\textwidth}

\figh{Crashes/Figs/chalabi-dearmona-speeding.png}{0.75}

\column{0.25\textwidth}

\figh{Crashes/Figs/chalabi-dearmona-drinking.png}{0.75}

\column{0.12\textwidth}

\end{columns}

\vspace{12pt}
\hfill \footnotesize \lolit
\href{https://fivethirtyeight.com/datalab/which-state-has-the-worst-drivers/}{\tt fivethirtyeight.com/datalab/which-state-has-the-worst-drivers}

\note{
}
\end{frame}


\begin{frame}[c]{An alternative}

\figh{Crashes/crashes.pdf}{0.85}

\note{
}
\end{frame}

\begin{frame}[c]{Scatterplots}

\figh{Crashes/crashes_scatter.pdf}{0.85}

\note{
}
\end{frame}



\begin{frame}{Summary I}

\bbi
\item Show the data

\item Avoid chart junk

\item Consider taking logs and/or differences

\item Put the things to be compared next to each other

\item Use color to set things apart, but consider color blind folks

\item Use position rather than angle or area to represent quantities
\ei

\note{
}
\end{frame}



\begin{frame}{Summary II}

\bbi
\item Align axes to ease comparisons

\item Use common axis limits to ease comparisons

\item Use labels rather than legends

\item Sort on meaningful variables (not alphabetically)

\item Must 0 be included in the axis limits?

\item Use scatterplots to explore relationships
\ei

\note{
}
\end{frame}





\begin{frame}{Inspirations}


\bbi
\item Hadley Wickham

\item Naomi Robbins

\item Howard Wainer

\item Andrew Gelman

\item Dan Carr

\item Edward Tufte
  \ei


  \note{
  }
\end{frame}





\begin{frame}{Further reading}

\vspace{-12pt}

  \bbi
\item ER Tufte (1983) The visual display of quantitative information.
Graphics Press.
\item ER Tufte (1990) Envisioning information. Graphics Press.
\item ER Tufte (1997) Visual explanations. Graphics Press.

\vspace{12pt}

\item A Gelman, C Pasarica, R Dodhia (2002) Let's practice what we preach:
Turning tables into graphs. The American Statistician 56:121-130

\vspace{12pt}

\item NB Robbins (2004) Creating more effective graphs. Wiley

\vspace{12pt}

\item Nature Methods columns: \href{https://bit.ly/points_of_view}{\tt bit.ly/points\_of\_view}
\ei

\note{
}
\end{frame}

\end{document}
