\documentclass[aspectratio=169,12pt,t]{beamer}
\usepackage{graphicx}
\setbeameroption{hide notes}
\setbeamertemplate{note page}[plain]
\usepackage{listings}

\input{../LaTeX/header.tex}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% end of header
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\title{The bootstrap}
\subtitle{Confidence intervals for QTL location}
\author{\href{https://kbroman.org}{Karl Broman}}
\institute{Biostatistics \& Medical Informatics, UW{\textendash}Madison}
\date{\href{https://kbroman.org}{\tt \scriptsize \color{foreground} kbroman.org}
\\[-4pt]
\href{https://github.com/kbroman}{\tt \scriptsize \color{foreground} github.com/kbroman}
\\[-4pt]
\href{https://twitter.com/kwbroman}{\tt \scriptsize \color{foreground} @kwbroman}
\\[-4pt]
{\scriptsize Course web: \href{https://kbroman.org/AdvData}{\tt kbroman.org/AdvData}}
}

\begin{document}

{
\setbeamertemplate{footline}{} % no page number here
\frame{
  \titlepage

\note{
  In this lecture, we'll look at the bootstrap; a method to get
  standard errors and confidence intervals by resampling one's own
  data. But then we'll proceed to an example where the bootstrap
  performs terribly.
}
} }


\begin{frame}[c]{}

  \figh{Figs/bootstrap_cover.jpg}{0.9}

\note{
  The bootstrap is crazy useful. Efron has a big book about it, but
  I'd start with this one.

  As I've emphasized before, computer simulation is really useful. The
  bootstrap can be seen as an extension of that point.
}

\end{frame}



\begin{frame}[c]{Example}

\only<1|handout 0>{\figw{Figs/bootstrap_illu_1.pdf}{1.0}}
\only<2>{\figw{Figs/bootstrap_illu_2.pdf}{1.0}}

\note{
  Consider the case that you are seeking to estimate the 95th
  percentile of some population.

  You have data on a random sample with $n$=1000. What can you say
  about the standard error of the sample estimate? How could we figure
  this out?

  Well, if we {\hilit knew} the population distribution, we could
  simulate from it. Simulate a sample of size $n$=1000, calculate the
  95th percentile, and then repeat that a bunch of times. The
  distribution of the estimates is what we're interested it; the SD is
  the standard error we're looking for.
}
\end{frame}



\begin{frame}[c]{Parametric bootstrap}

\only<1|handout 0>{\figw{Figs/bootstrap_illu_3.pdf}{1.0}}
\only<2>{\figw{Figs/bootstrap_illu_4.pdf}{1.0}}

\note{
  But of course we don't know the population distribution. But we
  might have a model for it (for example, that it follows a scaled
  chi-square distribution). We could use our data to estimate the
  population distribution.

  We could then simulate from the estimated population distribution,
  and determine the distribution (and so the SE) of our estimate in
  the case that the population follows that estimated distribution.

  This is called the {\hilit parametric bootstrap}: you have a model
  for the underlying population, you use your data to estimate that
  model, and then you simulate from the model in order to get an
  understanding of your target estimator.
}
\end{frame}





\begin{frame}[c]{Non-parametric bootstrap}

\only<1|handout 0>{\figw{Figs/bootstrap_illu_5.pdf}{1.0}}
\only<2>{\figw{Figs/bootstrap_illu_6.pdf}{1.0}}

\note{
  But if we have enough data, we could use the data itself (the
  {\hilit empirical distribution}) as an estimate of the population
  distribution. We could then simulate from {\vhilit that}.

  In other words, we make draws {\hilit with replacement} from our
  observed data, to create a new sample of the same size. We calculate
  our estimate with this re-sampled data, and then repeat many times,
  to get an estimate of the distribution of the estimator.

  This is called the {\hilit non-parametric bootstrap}: skip modeling
  the underlying population and just use your data to approximate the
  population, then simulate (re-sample) from that empirical
  distribution in order to get an understanding of your target
  estimator.
}
\end{frame}







\begin{frame}[c]{}

  \centering
  \Large
  \color{title}

  Don't think ``{\hilit re-sampling}''

  \bigskip \bigskip

  Think ``{\hilit simulate from an estimate of the population}''

\note{
  Folks often focus on the re-sampling aspect of the bootstrap. But I
  think it's better to focus on estimating the population distribution
  and then simulating from that estimate.

  The key idea in the bootstrap is not resampling, but estimating the
  population distribution with the empirical distribution.
}
\end{frame}





\begin{frame}[c]{}

  \centering
  \Large

  How can we tell if the bootstrap works?

  \bigskip \bigskip

  \onslide<2>{\vhilit Simulate!}


\note{
  The bootstrap works well in lots of cases. It's dependent on having
  a reasonably large dataset. And its performance depends on the
  nature of the estimate.

  How can we tell if it works? Well, we could simulate. Basically, we
  could create a {\vhilit nested bootstrap}.
}
\end{frame}








\begin{frame}{}

\figh{Figs/visscher1996.png}{0.9}

\note{
}
\end{frame}



\begin{frame}{LOD support interval}


\figh{Figs/hyper_lod.pdf}{0.85}

\vfill

\hfill {\footnotesize \lolit Data from Sugiyama et al.\ (2001) Genomics 71:70--77}

\note{
}

\end{frame}




\begin{frame}{Approximate Bayes interval}


\figh{Figs/hyper_bayes.pdf}{0.85}

\vfill

\hfill {\footnotesize \lolit Data from Sugiyama et al.\ (2001) Genomics 71:70--77}

\note{
}
\end{frame}



\begin{frame}{Bootstrap CI}


\figh{Figs/hyper_boot.pdf}{0.85}

\vfill

\hfill {\footnotesize \lolit Data from Sugiyama et al.\ (2001) Genomics 71:70--77}

\note{
}
\end{frame}











\begin{frame}{}

\figh{Figs/manichaikul2006.png}{0.9}

\note{
}
\end{frame}



\begin{frame}{Simulation study}


  \vspace*{-5mm}

  \bbi
\item {\hilit Backcross}, 200 individuals

\item One chromosome of length 100 cM

\item Markers at {\hilit 10 cM spacing}

\item {\hilit Single QTL} responsible for 10\% of phenotypic variance

\item Normally distributed residual variation

\item {\hilit Varied location of QTL}, at positions 0, 1, \dots, 100 cM

\item Analysis by standard interval mapping;
  calculations every 1 cM

\item 10,000 simulations for each QTL position

\item Bootstrap used 1000 replicates
\ei

\note{
}
\end{frame}


\begin{frame}[c]{Distribution of estimated location}

\figh{Figs/mle1.pdf}{0.9}

\note{
}
\end{frame}




\begin{frame}[c]{Distribution of estimated location}

\figh{Figs/mle2.pdf}{0.9}

\note{
}
\end{frame}




\begin{frame}[c]{Distribution of estimated location}

\figh{Figs/mle4.pdf}{0.9}

\note{
}
\end{frame}



\begin{frame}[c]{Coverage vs. true location}

\figh{Figs/coveraget.pdf}{0.9}

\note{
}
\end{frame}





\begin{frame}[c]{Coverage vs. estimated location}

\figh{Figs/coveragethat.pdf}{0.9}

\note{
}
\end{frame}






\end{document}
